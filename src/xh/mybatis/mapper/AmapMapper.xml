<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org/DTD Mapper 3.0" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="xh.mybatis.mapper.AmapMapper">
	<!--根据区域信息查询所有基站wlk -->
	<select id="bsByArea" resultType="java.util.HashMap"
		parameterType="java.util.List" useCache="true">
		select a.*,b.link as bsStatus from xhgmnet_bs_station as a left join
		xhgmnet_bsstatus as b on a.bsId=b.bsId where a.zone in (
		<foreach collection="list" item="z" separator=",">
			#{z}
		</foreach>
		) group by a.bsId
	</select>
	<!--根据级别信息查询所有基站wlk -->
	<select id="bsByLevel" resultType="java.util.HashMap"
		parameterType="java.util.List" useCache="true">
		select a.*,b.link as bsStatus from xhgmnet_bs_station as a left join
		xhgmnet_bsstatus as b on a.bsId=b.bsId where a.level in (
		<foreach collection="list" item="z" separator=",">
			#{z}
		</foreach>
		) group by a.bsId
	</select>

	<!--区域圈选查询 -->
	<select id="rectangle" parameterType="map"
		resultType="java.util.HashMap" useCache="true">
		select a.*,b.link as bsStatus from xhgmnet_bs_station as a left join
		xhgmnet_bsstatus as b on a.bsId=b.bsId where a.bsId in 
		<foreach item="item" index="index" collection="groupData" open="(" separator="," close=")">
         #{item}
        </foreach>
		group by a.bsId order by bsId asc limit #{start},#{limit}
	</select>
	<!--区域圈选总数 -->
	<select id="rectangleCount" parameterType="map" resultType="int"
		useCache="true">
		select count(*) from xhgmnet_bs_station where bsId in 
		<foreach item="item" index="index" collection="groupData" open="(" separator="," close=")">
         #{item}
        </foreach>
	</select>
	
	<!-- 根据基站id查询基站业务信息 -->
	<select id="businessByBsId" parameterType="String" resultType="java.util.List" useCache="true">
		select * from (select count(num1) as userNum from 
		(select COUNT(*) as num1 from xhgmnet_operations_userstatus where bsId=#{bsId} GROUP BY userId) as temp1) as tempA
		JOIN 
		(select COUNT(num2) as groupNum from
		(select COUNT(*) as num2 from xhgmnet_operations_userstatus where bsId=#{bsId} GROUP BY TGid) as temp2) as tempB
	</select>

</mapper>
