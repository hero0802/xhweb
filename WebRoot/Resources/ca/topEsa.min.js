function Certificate(r){var e={};if(e.certInfo=null,e._parseCert=function(r){var e,t=TCACore.getInstance(),n='{"certStoreNameArr" : ["MY", "Address"], "b64Cert" : "'+r+'"}';try{e=t.call("Certificate/parseCert",n)}catch(r){return TCACErr.throwErr(r,ERRMAP.CERTIFICATE_PARSE_ERROR),null}return e.certInfo},this._keyStoreName="",this._keyStoreType="",this._keyStoreContainer="",this._keySpec=0,this._certStoreName="",tcu.isStr(r))e.certInfo=e._parseCert(r),e.certInfo.b64=r;else{if(!tcu.isObj(r))return void TCACErr.throwErr(ERRMAP.CERTIFICATE_INIT_WRONGTYPE);e.certInfo=r}this._keyStoreName=e.certInfo.keyStoreName,this._keyStoreType=e.certInfo.keyStoreType,this._keyStoreContainer=e.certInfo.certContainerName,this._keySpec=e.certInfo.certKeySpec,this._certStoreName=e.certInfo.certStoreName,this.serialNumber=function(){return e.certInfo.SN},this.subject=function(){return e.certInfo.subject.winDn},this.issuer=function(){return e.certInfo.issuer.winDn},this.notBefore=function(){return e.certInfo.notBefore},this.notAfter=function(){return e.certInfo.notAfter},this.crlUrl=function(){return e.certInfo.crlUrl},this.signAlg=function(){return tcu.convSignAlg2Str(e.certInfo.signAlg)},this.publicKeyAlg=function(){return tcu.convPubKeyAlg2Str(e.certInfo.pubKeyAlg)},this.publicKeySize=function(){return tcu.convPubKeyAlg2Size(e.certInfo.pubKeyAlg)},this.keyUsage=function(){return tcu.convKeyUsageNum2Arr(e.certInfo.keyUsage)},this.extededKeyUsage=function(){return tcu.convExtKeyUsageOID2Name(e.certInfo.extKeyUsage)},this.toBase64=function(){return e.certInfo.b64},this.signMessage=function(r,t,n){if(t=void 0===t||t,void 0===n)n="RSA"===this.publicKeyAlg()?TCA.SHA1:TCA.SM3;else if(!tcu.checkHashAlg(this.publicKeyAlg(),n))return null;var i=TCACore.getInstance(),c=TCA.IO.MSG|TCA.IO.U8,a=r,s=TCA.IO.MSG|TCA.IO.B64,o="noSet",A=tcu.tcaAlg2SDKAlg(n),u=i.getCfg("signPkcs7WithAttr"),C=["MY","Address"],l=[e.certInfo.certID],T=tcu.sign(C,l,A,!1,!0,u,t,!0,c,a,s,o);return null!=T?T.result:null},this.signMessageRaw=function(r,t){if(void 0===t)t="RSA"===this.publicKeyAlg()?TCA.SHA1:TCA.SM3;else if(!tcu.checkHashAlg(this.publicKeyAlg(),t))return null;var n=TCA.IO.MSG|TCA.IO.U8,i=r,c=TCA.IO.MSG|TCA.IO.B64,a="noSet",s=tcu.tcaAlg2SDKAlg(t),o=["MY","Address"],A=[e.certInfo.certID],u=tcu.sign(o,A,s,!1,!1,!1,!1,!1,n,i,c,a);return null!=u?u.result:null},this.signFile=function(r,t,n,i,c){if(n=void 0===n||n,i=void 0===i?TCA.IO.BIN:i,void 0===c)c="RSA"===this.publicKeyAlg()?TCA.SHA1:TCA.SM3;else if(!tcu.checkHashAlg(this.publicKeyAlg(),c))return null;var a=TCACore.getInstance(),s=TCA.IO.FILE|i,o=r,A=TCA.IO.FILE|i,u=t,C=tcu.tcaAlg2SDKAlg(c),l=a.getCfg("signPkcs7WithAttr"),T=["MY","Address"],E=[e.certInfo.certID],S=tcu.sign(T,E,C,!1,!0,l,n,!0,s,o,A,u);return null!=S},this.signFileRaw=function(r,t,n){if(t=void 0===t?TCA.IO.BIN:t,void 0===n)n="RSA"===this.publicKeyAlg()?TCA.SHA1:TCA.SM3;else if(!tcu.checkHashAlg(this.publicKeyAlg(),n))return null;var i=TCA.IO.FILE|t,c=r,a=TCA.IO.MSG|TCA.IO.B64,s="noSet",o=tcu.tcaAlg2SDKAlg(n),A=["MY","Address"],u=[e.certInfo.certID],C=tcu.sign(A,u,o,!1,!1,!1,!1,!1,i,c,a,s);return null!=C?C.result:null},this.encryptMessage=function(r,e){void 0===e&&(e="SM2"==this.publicKeyAlg()?TCA.SM4:TCA.DES3,e=tcu.tcaAlg2SDKAlg(e));var t=[this.toBase64()],n=TCA.IO.MSG|TCA.IO.U8,i=r,c=TCA.IO.MSG|TCA.IO.B64,a="noSet",s=tcu.enc(t,e,!0,n,i,c,a);return null!=s?s.result:null},this.encryptMessageRaw=function(r){var e=[this.toBase64()],t=TCA.IO.MSG|TCA.IO.U8,n=r,i=TCA.IO.MSG|TCA.IO.B64,c="noSet",a=tcu.tcaAlg2SDKAlg(TCA.SM4),s=tcu.enc(e,a,!1,t,n,i,c);return null!=s?s.result:null},this.encryptFile=function(r,e,t,n){t=void 0===t?TCA.IO.BIN:t,n=tcu.tcaAlg2SDKAlg(TCA.SM4);var i=[this.toBase64()],c=TCA.IO.FILE|t,a=r,s=TCA.IO.FILE|t,o=tcu.enc(i,n,!0,c,a,s,e);return null!=o||null},this.verifyMessageRaw=function(r,e,t){if(void 0===t)t="RSA"===this.publicKeyAlg()?TCA.SHA1:TCA.SHA256;else if(!tcu.checkHashAlg(this.publicKeyAlg(),t))return null;var n=this.toBase64(),i=TCA.VERIFYOPT.CONTEXT_IN_INPUT|TCA.VERIFYOPT.CERT_IN_INPUT,c=TCA.IO.MSG|TCA.IO.B64,a=r,s=TCA.IO.MSG|TCA.IO.U8,o=tcu.tcaAlg2SDKAlg(t),A=tcu.verify(n,!1,!1,o,i,c,a,s,e);return null!=A&&A.verifyResult},this.verifyFileRaw=function(r,e,t,n){if(void 0===n)n="RSA"===this.publicKeyAlg()?TCA.SHA1:TCA.SHA256;else if(!tcu.checkHashAlg(this.publicKeyAlg(),n))return null;var i=this.toBase64(),c=TCA.VERIFYOPT.CONTEXT_IN_INPUT|TCA.VERIFYOPT.CERT_IN_INPUT,a=TCA.IO.MSG|TCA.IO.B64,s=r,o=TCA.IO.FILE|TCA.IO.BIN,A=tcu.tcaAlg2SDKAlg(n),u=tcu.verify(i,!1,!1,A,c,a,s,o,e);return null!=u},this.decryptMessageRaw=function(r){var t=["MY","Address"],n=[e.certInfo.certID],i=TCA.IO.MSG|TCA.IO.B64,c=r,a=TCA.IO.MSG|TCA.IO.U8,s="noSet",o=tcu.dec(t,n,!1,i,c,a,s);return null!=o?o.result:null},this.deleteCert=function(){var r,t=[e.certInfo.certID],n=TCACore.getInstance(),i='{"certStore" : ["MY", "Address"], "certIDArr" : ["'+t+'"]}';try{r=n.call("Certificate/deleteCert",i)}catch(r){return TCACErr.throwErr(r,ERRMAP.CERTIFICATE_DELETE_ERROR),!1}return null!=r},this.signLogonData=function(r){return this.signMessage("LOGONDATA:"+r)},this.signFile2File=this.signFile,this.signLogondata=this.signLogonData,this.encryptRaw=this.encryptMessageRaw,this.verifyFile=function(r,e,t){return r=null,e=null,t=null,TCACErr.throwErr(ERRMAP.UNIMPLEMENTED),null},this.verifyRaw=this.verifyMessageRaw,this.Delete=this.deleteCert,this.b64str=this.toBase64,this.exportPFX=function(r){return r=null,TCACErr.throwErr(ERRMAP.UNIMPLEMENTED),null},this.exportPFX2File=function(r,e){return r=null,e=null,TCACErr.throwErr(ERRMAP.UNIMPLEMENTED),null},this.show=function(){return TCACErr.throwErr(ERRMAP.UNIMPLEMENTED),null}}function CertSet(r){var e={};if(e.certArr=[],r instanceof Array){if(0!=r.length)if(r[0]instanceof Certificate)e.certArr=r;else{if(!tcu.isStr(r[0]))return void TCACErr.throwErr(ERRMAP.CERT_SET_INIT_ERROR_TYPE);for(var t=0;t<r.length;t++)e.certArr.push(new Certificate(r[t]))}}else if(tcu.isStr(r))e.certArr.push(new Certificate(r));else{if(r instanceof Pkcs7)return void TCACErr.throwErr(ERRMAP.CERT_SET_INIT_ERROR_TYPE_2);if(r instanceof Certificate)e.certArr.push(r);else if(0!=arguments.length)return void TCACErr.throwErr(ERRMAP.CERT_SET_INIT_ERROR_TYPE_3)}this.size=function(){return e.certArr.length},this.get=function(r){return e.certArr[r]},this.bySerialnumber=function(r){for(var t=0;t<e.certArr.length;t++)if(e.certArr[t].serialNumber()===r.toUpperCase())return new CertSet(e.certArr[t]);return new CertSet},this.bySubject=function(r){for(var t=[],n=0;n<e.certArr.length;n++)e.certArr[n].subject().search(r)>=0&&t.push(e.certArr[n]);return 0==t.length?new CertSet:new CertSet(t)},this.byIssuer=function(r){for(var t=[],n=0;n<e.certArr.length;n++)e.certArr[n].issuer().search(r)>=0&&t.push(e.certArr[n]);return 0==t.length?new CertSet:new CertSet(t)},this.byValidity=function(r){for(var t=0==arguments.length?new Date:new Date(date),n=[],i=0;i<e.certArr.length;i++)e.certArr[i].notBefore()<=t&&t<=e.certArr[i].notAfter()&&n.push(e.certArr[i]);return 0==n.length?new CertSet:new CertSet(n)},this.byKeyUsage=function(r){var t=0;if(r instanceof Array)t=tcu.convKeyUsageArr2Num(r);else{if(!tcu.isNum(r))return TCACErr.throwErr(ERRMAP.CERT_SET_FILTER_KEYUSAGE_ERROR),null;t=r}for(var n=[],i=0;i<e.certArr.length;i++){var c=tcu.convKeyUsageArr2Num(e.certArr[i].keyUsage());(c&t)==t&&n.push(e.certArr[i])}return 0==n.length?new CertSet:new CertSet(n)},this.forSign=function(){return this.byKeyUsage(128)},this.forEncrypt=function(){return this.byKeyUsage(32)},this.bySubjcet=this.bySubject,this.encryptMessage=function(r,e){return TCACErr.throwErr(ERRMAP.UNIMPLEMENTED),null},this.encryptFile=function(r,e,t,n){return TCACErr.throwErr(ERRMAP.UNIMPLEMENTED),null},this.uiSelect=function(){return TCACErr.throwErr(ERRMAP.UNIMPLEMENTED),null}}function CertStore(r,e){if(!tcu.isStr(r)||!tcu.isNum(e))return TCACErr.throwErr(ERRMAP.CERTSTORE_INIT_WRONGTYPE),null;var t=TCACore.getInstance();r=t.getCfg("useAlias")?t.alias2Full(r):r;var n={};n.storeName=r,n.storeType=e,this.genCsr=function(r,e){var t,i,c=TCACore.getInstance(),a=1,s="topca",o=c.getCfg("genKeySpec"),A=c.getCfg("exportKeyAble")?1:0,u="noSet",C=c.getCfg("genCsrUseSHA256")?TCA.SHA256:TCA.SHA1;if(1===arguments.length)if(tcu.isStr(r))a=1,t=tcu.tcaAlg2SDKAlg(r),i=r==TCA.SM2?tcu.tcaAlg2SDKAlg(TCA.SM3):tcu.tcaAlg2SDKAlg(C);else{if(!(r instanceof Certificate))return TCACErr.throwErr(ERRMAP.GEN_CSR_ERROR_PARAMS),null;var l,T=r.publicKeyAlg(),E=r.publicKeySize();if("RSA"===T&&1024===E)l=TCA.RSA1024;else if("RSA"==T&&2048===E)l=TCA.RSA2048;else{if("SM2"!=T)return TCACErr.throwErr(ERRMAP.GEN_CSR_ERR_PUBKEY_ALG),null;l=TCA.SM2}a=2,t=tcu.tcaAlg2SDKAlg(l),i=l==TCA.SM2?tcu.tcaAlg2SDKAlg(TCA.SM3):tcu.tcaAlg2SDKAlg(C),o=r._keySpec,u=r._keyStoreContainer}else if(2===arguments.length)a=1,s=e,t=tcu.tcaAlg2SDKAlg(r),i=r==TCA.SM2?tcu.tcaAlg2SDKAlg(TCA.SM3):tcu.tcaAlg2SDKAlg(C);else{if(0!==arguments.length)return TCACErr.throwErr(ERRMAP.GEN_CSR_ERROR_PARAMS),null;a=1,t=tcu.tcaAlg2SDKAlg(TCA.SM2),i=tcu.tcaAlg2SDKAlg(TCA.SM3)}var S,R='{"mode" : '+a+',"subject" : "'+s+'","provName" : "'+n.storeName+'","provType" : '+n.storeType+',"containerName" : "'+u+'","keySpec" :'+o+',"keyAlg" :'+t+',"hashAlg" : '+i+',"opation" : '+A+"}";try{S=c.call("Csr/genCsr",R)}catch(r){return TCACErr.throwErr(r,ERRMAP.GEN_CSR_ERROR),null}return new Csr(S.csrInfo)},this.listCerts=function(){for(var r=CertStore.listAllCerts(),e=[],t=0;t<r.length;t++){var i=r[t];i._keyStoreName===n.storeName&&e.push(i)}return new CertSet(e)},this.getSupportedKeyAlgs=function(){return TCACErr.throwErr(ERRMAP.UNIMPLEMENTED),null},this.importPFX=function(r,e){return r=null,e=null,TCACErr.throwErr(ERRMAP.UNIMPLEMENTED),null},this.importPFXFile=function(r,e){return r=null,e=null,TCACErr.throwErr(ERRMAP.UNIMPLEMENTED),null}}function Csr(r){var e={};e.csrInfo=null,tcu.isObj(r)?e.csrInfo=r:TCACErr.throwErr(ERRMAP.CSR_INIT_ERROR_TYPE),this.subject=function(){return e.csrInfo.subject.winDN},this.toBase64=function(){return e.csrInfo.b64}}function Pkcs7(r){var e={};if(e.pkcs7Info=null,!tcu.isStr(r))return TCACErr.throwErr(ERRMAP.PKCS7_INIT_ERROR_TYPE),null;var t,n='{"inType" : '+(TCA.IO.MSG|TCA.IO.B64)+', "inParam" : "'+r+'", "certs" : true, "content" : true, "b64" : false}',i=TCACore.getInstance();try{t=i.call("Pkcs7/parsePkcs7",n)}catch(r){return TCACErr.throwErr(r,ERRMAP.LIST_CERT_ERROR),null}e.pkcs7Info=t.pkcs7Info,e.pkcs7Info.b64=r,this.verifyMessage=function(r){var t,n="",i=TCA.VERIFYOPT.CERT_IN_P7,c=TCA.IO.MSG|TCA.IO.U8;void 0!=r?(i|=TCA.VERIFYOPT.CONTEXT_IN_INPUT,t=r):(i|=TCA.VERIFYOPT.CONTEXT_IN_P7,t="noSet");var a=TCA.IO.MSG|TCA.IO.B64,s=e.pkcs7Info.b64,o=tcu.verify(n,!1,!0,1,i,a,s,c,t);return null===o?null:o.verifyResult?new Certificate(o.b64Cert):null},this.decryptMessage=function(){var r=["MY","Address"],t=[],n=TCA.IO.MSG|TCA.IO.B64,i=e.pkcs7Info.b64,c=TCA.IO.MSG|TCA.IO.U8,a="noSet",s=tcu.dec(r,t,!0,n,i,c,a);return null!=s?s.result:null},this.contentMessage=function(){return e.pkcs7Info.isSigned&&e.pkcs7Info.hasContent?e.pkcs7Info.content:null},this.verify=this.verifyMessage,this.toBase64=function(){return e.pkcs7Info.b64}}function TCACErr(r){this._errarr=[],r instanceof TCACErr&&(this._errarr=r._errarr),this.addErr=function(r){var e=r.code,t=r.msg;this.number=e>0?e:4294967296+e,this.description=t,this._errarr.push({code:this.number.toString(16).toUpperCase(),msg:t})},this.toStr=function(){for(var r="",e=0;e<this._errarr.length;e++)r+=this._errarr[e].msg+", 错误码：0x"+this._errarr[e].code+", \r\n";return r.substr(0,r.length-4)}}function tcu(){}CertStore.listAllCerts=function(){for(var r=TCACore.getInstance(),e=["MY","Address"],t=[],n=0;n<e.length;n++){var i='{"certStoreName" : "'+e[n]+'", "needB64" : true}',c=null;try{c=r.call("CertStore/listCerts",i)}catch(r){return TCACErr.throwErr(r,ERRMAP.LIST_CERT_ERROR),new CertSet}for(var a=c.certArr,s=0;s<a.length;s++){a[s].notBefore=new Date(a[s].notBefore),a[s].notAfter=new Date(a[s].notAfter);var o=new Certificate(a[s]);r.certInLic(o)&&t.push(o)}}return new CertSet(t)},CertStore.listStore=function(r){for(var e=CertStore.listKeyStore(r),t=[],n=0;n<e.length;n++)t.push(e[n].name);return t},CertStore.byName=function(r){for(var e=CertStore.listKeyStore(!1),t=0;t<e.length;t++)if(r===e[t].name)return new CertStore(e[t].name,e[t].type);return null},CertStore.byCert=function(r){return r instanceof Certificate?new CertStore(r._keyStoreName,r._keyStoreType):(TCACErr.throwErr(ERRMAP.BY_CERT_ERR_TYPE),null)},CertStore.installCert=function(r,e,t){var n,i,c=TCACore.getInstance();if(1===arguments.length)n="InstallSignCert/installSignCert",i='{"certStoreName"   : "MY", "caCertStoreName" : "Ca", "b64SignCertP7"   : "'+r+'"}';else{if(3!==arguments.length)return TCACErr.throwErr(ERRMAP.INSTALL_CERT_ERR_PARAMS),null;n="InstallEncCert/installEncCert";for(var a=t.split("&"),s={},o=0;o<a.length;o++){var A=a[o].split("=");s[A[0]]=tcu.urlDec(A[1])}var u,C=s.userSeal,l=s.encPrivateKeyUser,T=s.userCipher,E=s.userIV;switch(T){case"AES":case"AES_128":u=TCA.AES;break;case"DES":u=TCA.DES;break;case"DESEDE":case"DES3":case"3DES":u=TCA.DES3;break;case"SM4":case"SMS4":u=TCA.SM4;break;case"SM1":u=TCA.SM1;break;case"rc2":case"AES_192":case"AES_256":return TCACErr.throwErr(ERRMAP.INSTALL_CERT_ERR_UNKNOWN_SYMMALG),null;default:u=TCA.AES}u=tcu.tcaAlg2SDKAlg(u);var S,R=new Certificate(r),g=R._keyStoreName;S=g.indexOf("Microsoft")>=0||g.indexOf("iTrus")>=0||"RSA"==g?1:c.getCfg("installMode")?2:1,i='{"certStoreName" : "MY", "mode" : '+S+', "b64SignCert" : "'+r+'", "b64UserSeal" : "'+C+'", "b64EncUserCert" : "'+e+'", "b64EncUserPrivateKey" : "'+l+'", "symmAlg" : '+u+', "b64IV" : "'+E+'"}'}var f;try{f=c.call(n,i)}catch(r){return TCACErr.throwErr(r,ERRMAP.INSTALL_CERT_ERR),null}return new Certificate(f.certInfo)},CertStore.listKeyStore=function(r){var e=TCACore.getInstance(),t='{"mode" : 1 }',n=null;try{n=e.call("KeyStore/listKeyStore",t)}catch(r){return TCACErr.throwErr(r,ERRMAP.LIST_STORE_ERROR),[]}var i=n.keyStoreArr;e.setKeyStoreListCache(i),r=!e.getCfg("disableWhiteList")&&r;for(var c=e.getCfg("whiteList"),a=e.getCfg("useAlias"),s=[],o=0;o<i.length;o++){var A=i[o].name;r?tcu.strInList(A,c)&&s.push({name:a?e.full2Alias(A):A,type:i[o].type}):s.push({name:a?e.full2Alias(A):A,type:i[o].type})}return s},Pkcs7.verifyFile=function(r,e,t,n){var i,c="",a=TCA.VERIFYOPT.CERT_IN_P7,s=TCA.IO.FILE|TCA.IO.BIN;void 0!=e?(a|=TCA.VERIFYOPT.CONTEXT_IN_INPUT,i=e):(a|=TCA.VERIFYOPT.CONTEXT_IN_P7,i="noSet");var o=TCA.IO.FILE|TCA.IO.BIN,A=r,u=tcu.verify(c,!1,!0,1,a,o,A,s,i);return null===u?null:u.verifyResult?new Certificate(u.b64Cert):null},Pkcs7.contentFile=function(r,e,t){return TCACErr.throwErr(ERRMAP.UNIMPLEMENTED),null},Pkcs7.decryptFile=function(r,e,t){t=void 0===t?TCA.IO.BIN:t;var n=["MY","Address"],i=[""],c=TCA.IO.FILE|t,a=r,s=TCA.IO.FILE|t,o=e,A=tcu.dec(n,i,!0,c,a,s,o);return null!=A};var TCA={};TCA.config=function(r){TCACore.getInstance(r)},TCA.SM1="SM1",TCA.SM4="SM4",TCA.DES="DES",TCA.DES3="3DES",TCA.AES="AES",TCA.RC4="RC4",TCA.SM2="SM2",TCA.RSA1024="RSA1024",TCA.RSA2048="RSA2048",TCA.SHA256="SHA256",TCA.SHA1="SHA1",TCA.SM3="SM3",TCA.MD5="MD5",TCA.digitalSignature=128,TCA.nonRepudiation=64,TCA.keyEncipherment=32,TCA.dataEncipherment=16,TCA.keyAgreement=8,TCA.keyCertSign=4,TCA.cRLSign=2,TCA.encipherOnly=1,TCA.decipherOnly=32768,TCA.contentCommitment=64,TCA.serverAuth="1.3.6.1.5.5.7.3.1",TCA.clientAuth="1.3.6.1.5.5.7.3.2",TCA.codeSigning="1.3.6.1.5.5.7.3.3",TCA.emailProtection="1.3.6.1.5.5.7.3.4",TCA.ipsecEndSystem="1.3.6.1.5.5.7.3.5",TCA.ipsecTunnel="1.3.6.1.5.5.7.3.6",TCA.ipsecUser="1.3.6.1.5.5.7.3.7",TCA.timeStamping="1.3.6.1.5.5.7.3.8",TCA.OCSPSigning="1.3.6.1.5.5.7.3.9",TCA.dvcs="1.3.6.1.5.5.7.3.10",TCA.sbgpCertAAServerAuth="1.3.6.1.5.5.7.3.11",TCA.scvpResponder="1.3.6.1.5.5.7.3.12",TCA.eapOverPPP="1.3.6.1.5.5.7.3.13",TCA.eapOverLAN="1.3.6.1.5.5.7.3.14",TCA.scvpServer="1.3.6.1.5.5.7.3.15",TCA.scvpClient="1.3.6.1.5.5.7.3.16",TCA.ipsecIKE="1.3.6.1.5.5.7.3.17",TCA.capwapAC="1.3.6.1.5.5.7.3.18",TCA.capwapWTP="1.3.6.1.5.5.7.3.19",TCA.smartcardlogon="1.3.6.1.4.1.311.20.2.2",TCA.EX={},TCA.EX.szOID_RSA_MD5RSA="1.2.840.113549.1.1.4",TCA.EX.szOID_RSA_SHA1RSA="1.2.840.113549.1.1.5",TCA.EX.szOID_SM2_SM3SM2="1.2.156.10197.1.501",TCA.EX.INPUT_BASE64=1,TCA.EX.INPUT_HEX=2,TCA.EX.OUTPUT_BASE64=4,TCA.EX.OUTPUT_HEX=8,TCA.EX.INNER_CONTENT=16,TCA.EX.PLAINTEXT_UTF8=32,TCA.EX.ONLY_SIGNATURE=512,TCA.EX._pta_OverlapPeriod=30,TCA.EX.FUNCOPT_NOALERT=2147483648,TCA.EX.PARAM_FILENAME=4096,TCA.EX.PARAM_STRING=8192,TCA.EX.PTA_CALG_SHA256=2097152,TCA.EX.PFX_BASE64=8,TCA.EX.SIGNOPTION_P7=1,TCA.EX.SIGNOPTION_RAW=2,TCA.EX.SIGNOPTION_P7_INNER_CONTEXT=256,TCA.EX.SIGNOPTION_P7_INNER_CERT=512,TCA.EX.SIGNOPTION_P7_INNER_AUTHATTR=1024,TCA.EX.PARAM_IN_FILE=1,TCA.EX.PARAM_IN_MSG=2,TCA.EX.PARAM_OUT_FILE=4,TCA.EX.PARAM_OUT_MSG=8,TCA.EX.PARAM_TO_U16=256,TCA.EX.PARAM_TO_U8=512,TCA.EX.PARAM_IN_B64=1024,TCA.EX.PARAM_OUT_B64=2048,TCA.EX.PARAM_INC_CERT=16777216,TCA.EX.PARAM_INC_CONTEXT=33554432,TCA.EX.SM2_SOFT_CSP_NAME="iTrusChina Cryptographic Service Provider v1.0.0",TCA.EX.CRYPT_EXPORTABLE=1,TCA.IO={},TCA.IO.MSG=1,TCA.IO.FILE=2,TCA.IO.SELFILE=4,TCA.IO.BIN=65536,TCA.IO.B64=131072,TCA.IO.HEX=262144,TCA.IO.U8=524288,TCA.VERIFYOPT={},TCA.VERIFYOPT.CONTEXT_IN_P7=1,TCA.VERIFYOPT.CONTEXT_IN_INPUT=2,TCA.VERIFYOPT.CERT_IN_P7=16,TCA.VERIFYOPT.CERT_IN_INPUT=32,TCA.EX.exkeyusagemap={"1.3.6.1.5.5.7.3.1":"serverAuth","1.3.6.1.5.5.7.3.2":"clientAuth","1.3.6.1.5.5.7.3.3":"codeSigning","1.3.6.1.5.5.7.3.4":"emailProtection","1.3.6.1.5.5.7.3.5":"ipsecEndSystem","1.3.6.1.5.5.7.3.6":"ipsecTunnel","1.3.6.1.5.5.7.3.7":"ipsecUser","1.3.6.1.5.5.7.3.8":"timeStamping","1.3.6.1.5.5.7.3.9":"OCSPSigning","1.3.6.1.5.5.7.3.10":"dvcs","1.3.6.1.5.5.7.3.11":"sbgpCertAAServerAuth","1.3.6.1.5.5.7.3.12":"scvpResponder","1.3.6.1.5.5.7.3.13":"eapOverPPP","1.3.6.1.5.5.7.3.14":"eapOverLAN","1.3.6.1.5.5.7.3.15":"scvpServer","1.3.6.1.5.5.7.3.16":"scvpClient","1.3.6.1.5.5.7.3.17":"ipsecIKE","1.3.6.1.5.5.7.3.18":"capwapAC","1.3.6.1.5.5.7.3.19":"capwapWTP","1.3.6.1.4.1.311.20.2.2":"smartcardlogon"},TCA.filter2Str=function(r){for(var e="",t=0;t<r.length;t++){var n=r[t],i="";for(var c in n)i+=n[c]+"|";e+=i}return e},TCA.doFileDialog=function(r,e,t,n){function i(r){var e=""!=r.result;t(e,r.result)}null==t&&TCACErr.throwErr(ERRMAP.ERROR_NULL_CALLBACK),null!==e&&tcu.isArr(e)||(e=[{typeTxt:"All(*.*)",typeExt:"*.*"}]);var c=TCA.filter2Str(e),a={isOpen:n,title:r,filter:c};a=tcu.json2Str(a);var s=TCACore.getInstance();try{s.callAsyn("FileUtil/SelFile",a,i)}catch(r){return TCACErr.throwErr(r,ERRMAP.ERROR_FILE_DIALOG),null}},TCA.showOpenDialog=function(r,e,t){null!==r&&""!==r||(r="打开"),TCA.doFileDialog(r,e,t,!0)},TCA.showSaveDialog=function(r,e,t){null!==r&&""!==r||(r="关闭"),TCA.doFileDialog(r,e,t,!1)};var TCACore=function(){function saveConfig(r){priData.config={},priData.config.ajaxHdl=void 0!==r.ajaxHdl?r.ajaxHdl:tcu.ajax,priData.config.str2JsonHdl=void 0!==r.str2JsonHdl?r.str2JsonHdl:tcu.convStr2Json,priData.config.certkitClsID="40CAB063-EF31-4ff6-B512-E1E4E454EB19",priData.config.certKitSrvHost="127.0.0.1",priData.config.certKitSrvPort="9655",priData.config.certKitSrvUrl="https://"+priData.config.certKitSrvHost+":"+priData.config.certKitSrvPort+"/",priData.config.certKitSrvVer="3.6.0.2",priData.config.certKitActiveXVer="3.6.0.2",priData.config.licver="3.6.0.2",priData.config.licsoftver="3.6.0.2",priData.config.selfNameFmt="TopCertKit-\\d+(\\.\\d+)*.js",priData.config.selfPath=getSelfPath(),priData.config.useAlias=void 0===r.useAlias||r.useAlias,priData.config.disableExeUrl=void 0!==r.disableExeUrl&&r.disableExeUrl,void 0!==r.cspAlias?priData.config.cspAlias=r.cspAlias:priData.config.cspAlias={"RSA软证书":"Microsoft Enhanced Cryptographic Provider v1.0","飞天 ePass 3000 GM":"EnterSafe ePass3000GM CSP v1.0","华大智宝 SJK102":"CIDC Cryptographic Service Provider v3.0.0","SM2软证书":"iTrusChina Cryptographic Service Provider v1.0.0","神州龙芯":"ChinaCpu USB Key CSP v1.0"},priData.config.addCspAlias=void 0!==r.addCspAlias?r.addCspAlias:{};for(var e in priData.config.addCspAlias)priData.config.cspAlias[e]=priData.config.addCspAlias[e];priData.config.disableWhiteList=void 0!==r.disableWhiteList&&r.disableWhiteList,void 0!==r.whiteList?priData.config.whiteList=r.whiteList:priData.config.whiteList=["Microsoft Enhanced Cryptographic Provider v1.0","iTrusChina Cryptographic Service Provider v1.0.0"],priData.config.addWhiteList=void 0!==r.addWhiteList?r.addWhiteList:[];for(var t=0;t<priData.config.addWhiteList.length;t++)priData.config.whiteList.push(priData.config.addWhiteList[t]);priData.config.lic=void 0!==r.license?r.license:null,priData.config.licinfo=null,priData.config.urlArr=null,priData.config.autoExePath=void 0!==r.autoExePath&&r.autoExePath,priData.config.installMode=void 0===r.installMode||r.installMode,priData.config.exportKeyAble=void 0===r.exportKeyAble||r.exportKeyAble,void 0===r.exepath?priData.config.exepath=priData.config.selfPath+"TopCertKit-"+priData.config.exeVer+".exe":priData.config.exepath=r.exepath,priData.config.genKeySpec=void 0!==r.genKeySpec?r.genKeySpec:1,1!=priData.config.genKeySpec&&2!=priData.config.genKeySpec&&(priData.config.genKeySpec=1),priData.config.genCsrUseSHA256=void 0!==r.genCsrUseSHA256&&r.genCsrUseSHA256,priData.config.signPkcs7WithAttr=void 0!==r.signPkcs7WithAttr&&r.signPkcs7WithAttr,priData.config.enableAutoAuth=void 0!==r.enableAutoAuth&&r.enableAutoAuth,priData.config.autoAuthUrl=void 0!==r.autoAuthUrl?r.autoAuthUrl:""}function getSelfPath(){for(var r,e=document.getElementsByTagName("script"),t=new RegExp("(.*/)+"),n=0;n<e.length;n++)if(r=e[n].getAttribute("src"),null!==r&&!(r.search("TopCertKit-\\d{5}.js")<0)){r=r.match(t)[0];break}return r}function doGetEnct(){var r,e='{"method" : "gen","param1" : "", "param2" : "", "param3" : ""}',t=TCACore.getInstance();try{r=t.call("token/token",e)}catch(r){return TCACErr.throwErr(r,ERRMAP.AUTOAUTH_ERROR_2),null}return r.retStr1}function doVerifyToken(r,e){var t,n='{"method" : "verify","param1" : "'+r+'", "param2" : "'+e+'", "param3" : ""}',i=TCACore.getInstance();try{t=i.call("token/token",n)}catch(r){return TCACErr.throwErr(r,ERRMAP.AUTOAUTH_ERROR_2),!1}return!0}function verifyAutoAuth(){var r=priData.config.autoAuthUrl;""!==r&&void 0!==r&&null!==r||TCACErr.throwErr(ERRMAP.INVALID_CONFIG);var e=doGetEnct(),t="d={'winterIsComing': \""+e+'", \'v\' : "1"}';$.ajax({type:"post",async:!1,url:r,dataType:"json",data:t,success:function(r){ret=doVerifyToken(e,r.t)},error:function(r,e,t){ret=!1}}),ret?priData.config.licinfo={Issuer:".*"}:TCACErr.throwErr(ERRMAP.AUTOAUTH_ERROR)}function verifyLicense(){var pkcs7=new Pkcs7(priData.config.lic),cert=pkcs7.verifyMessage();"5F259CDACC82BB7EF305B3007B8B8EC9BDF9B5F2"!=cert.serialNumber()&&TCACErr.throwErr(ERRMAP.INVALID_LICENSE_2);var info=pkcs7.contentMessage();priData.config.licinfo=eval("("+info+")")}function gotoExeUrl(){if(priData.config.disableExeUrl)throw TCACErr.throwErr(ERRMAP.INSTALL_ACTIVEX_ERR);window.location=priData.config.exepath}function loadCertKitSrv(){return!0}function getSrvVersion(){return!0}function loadCertKitActiveX(){try{var r="<object id='TopCertKit' classid='clsid:"+priData.config.certkitClsID+"' ";r+="></object>";var e=document.getElementById("CertKitDiv");null!==e&&""!==e||(e=document.createElement("div"),e.setAttribute("id","CertKitDiv"),e.innerHTML=r,document.body.appendChild(e)),priData.certKitSrvActiveX=document.getElementById("TopCertKit")}catch(r){throw r}}function checkCertKitVer(){var r=!1;return isIE()?r=priData.certKitSrvActiveX.ver==priData.config.certKitActiveXVer:(r=getSrvVersion()==priData.config.certKitActiveXVer,r=!0),r}function isIE(){var r=navigator.userAgent;return r.indexOf("MSIE")>0||r.toLocaleLowerCase().indexOf("trident")>-1}function loadCertKit(){return isIE()?loadCertKitActiveX():loadCertKitSrv()}function callSrv(r,e){var t=priData.config.certKitSrvUrl+r,n={},i=!1,c=function(r){i=!0,n=r},a=function(r,e,t){i=!1,n.request=r,n.status=e,n.err=t};if(priData.config.ajaxHdl({type:"POST",url:t,async:!1,contentType:"application/json; charset=utf-8",dataType:"json",data:e,success:c,error:a}),!i){var s="["+n.request.readyState+"]["+n.request.status+"]["+n.status+"]["+n.err.toString()+"]";throw new TCACErr(4278190081,s)}return n.retCode!=ERRMAP.SUPER_SUCCESS.code&&TCACErr.throwErr(TCACErr.newErr(ERRMAP.CALL_HTTP_CLIENT_ERR),{code:n.retCode,msg:n.retMsg}),n}function callActiveX(r,e){var t=null;try{r="/"+r,t=priData.certKitSrvActiveX.reqHdl(r,e)}catch(r){var n=TCACErr.newErr({code:r.number,msg:r.description});return TCACErr.throwErr(n,ERRMAP.CALL_ACTIVEX_ERR),null}if(t=priData.config.str2JsonHdl(t),0!=t.retCode){var i=TCACErr.newErr(ERRMAP.CALL_ACTIVEX_ERR_METHOD);return TCACErr.throwErr(i,{code:t.retCode,msg:t.retMsg}),null}return t}var priData={};priData.config=null,priData.cacheKeyStoreList=null,priData.certKitSrvActiveX=null,saveConfig({});var instanceClass=function(){this.getCfg=function(r){return priData.config[r]},this.setKeyStoreListCache=function(r){priData.cacheKeyStoreList=r},this.getLicInfo=function(r){return null==priData.config.licinfo,priData.config.licinfo[r]},this.full2Alias=function(r){for(var e in priData.config.cspAlias)if(priData.config.cspAlias.hasOwnProperty(e)&&priData.config.cspAlias[e]==r)return e;return r},this.alias2Full=function(r){var e=priData.config.cspAlias[r];return void 0===e?r:e},this.certInLic=function(r){var e=new RegExp(this.getLicInfo("Issuer"));return e.test(r.issuer())};var r={};r.query=isIE()?callActiveX:callSrv,this.call=function(e,t){return r.query(e,t)}},_instance=null,getInstance=function(r){if(void 0!==r&&null!==r&&saveConfig(r),null===_instance){if(_instance=new instanceClass,loadCertKit(),!checkCertKitVer())return void gotoExeUrl();priData.config.enableAutoAuth?verifyAutoAuth():verifyLicense()}return _instance};return{getInstance:getInstance}}();TCACErr.newErr=function(r,e){var t=null;return r instanceof TCACErr?(t=new TCACErr(r),t.addErr(e)):(t=new TCACErr,t.addErr(r)),t},TCACErr.throwErr=function(r,e){throw r instanceof TCACErr?TCACErr.newErr(r,e):TCACErr.newErr(r)};var ERRMAP_ZHCN={CERTSTORE_INIT_WRONGTYPE:{code:16777217,msg:"CertStore实例初始化失败，参数类型不匹配"},LIST_STORE_ERROR:{code:16777218,msg:"列举密钥库错误"},BY_CERT_ERR_TYPE:{code:16777219,msg:"根据证书获取CertStore实例时失败，参数类型不匹配"},LIST_CERT_ERROR:{code:16777220,msg:"列举证书错误"},GEN_CSR_ERROR_PARAMS:{code:16777221,msg:"产生CSR失败，输入参数错误"},GEN_CSR_ERR_PUBKEY_ALG:{code:16777222,msg:"产生CSR失败，未知的证书公钥算法"},GEN_CSR_ERROR:{code:16777223,msg:"产生CSR失败"},INSTALL_CERT_ERR_PARAMS:{code:16777224,msg:"安装证书失败，输入参数错误"},INSTALL_CERT_ERR_UNKNOWN_SYMMALG:{code:16777225,msg:"安装加密证书失败，未知的对称加密算法"},INSTALL_CERT_ERR:{code:16777226,msg:"安装证书失败"},CERTIFICATE_INIT_WRONGTYPE:{code:33554433,msg:"Certificate实例初始化失败，参数类型不匹配"},CERTIFICATE_PARSE_ERROR:{code:33554434,msg:"从Base64解析证书失败"},CERTIFICATE_DELETE_ERROR:{code:33554435,msg:"删除证书失败"},CERT_SET_INIT_ERROR_TYPE:{code:50331649,msg:"初始化CertSet实例失败，错误的输入类型"},CERT_SET_INIT_ERROR_TYPE_2:{code:50331650,msg:"初始化CertSet实例失败，错误的输入类型"},CERT_SET_INIT_ERROR_TYPE_3:{code:50331651,msg:"初始化CertSet实例失败，错误的输入类型"},CERT_SET_FILTER_KEYUSAGE_ERROR:{code:50331652,msg:"通过密钥用法过滤失败，错误的输入类型"},CSR_INIT_ERROR_TYPE:{code:67108865,msg:"初始化Csr实例失败，错误的输入类型"},PKCS7_INIT_ERROR_TYPE:{code:83886081,msg:"初始化Pkcs7实例失败，错误的输入类型"},PKCS7_INIT_PARSE_ERROR:{code:83886082,msg:"初始化Pkcs7实例失败，解析Pkcs7数据失败"},SIGN_ERROR:{code:2684354561,msg:"签名操作失败"},SIGN_ERROR_HASH_ALG:{code:100663297,msg:"哈希算法与签名算法不匹配"},VERIFY_ERROR:{code:2684354562,msg:"验证签名操作失败"},ENCRYPT_ERROR:{code:2684354563,msg:"加密操作失败"},DECRYPT_ERROR:{code:2684354564,msg:"解密操作失败"},ERROR_HASH_ALG:{code:2952790017,msg:"指定了错误的Hash算法算法"},ERROR_JSON_TYPE:{code:2952790018,msg:"错误的json类型"},ERROR_CALL_SRV_VER:{code:2952790019,msg:"查询服务版本失败"},CALL_HTTP_CLIENT_ERR:{code:4026531841,msg:"执行本地方法失败"},INVALID_LICENSE:{code:4026531842,msg:"使用了无效的License"},INVALID_CERTKIT_VER:{code:4026531843,msg:"不匹配的CertKit版本"},CALL_ACTIVEX_ERR:{code:4026531844,msg:"执行本地方法失败"},CALL_ACTIVEX_ERR_METHOD:{code:4026531845,msg:"执行操作失败"},INSTALL_ACTIVEX_ERR:{code:4026531846,msg:"无法加载ActiveX控件"},INVALID_LICENSE_2:{code:4026531847,msg:"使用了无效的License"},INVALID_CONFIG:{code:4026531848,msg:"无效的配置"},AUTOAUTH_ERROR:{code:4026531849,msg:"autoautherror"},AUTOAUTH_ERROR_2:{code:4026531850,msg:"autoautherror2"},UNIMPLEMENTED:{code:1,msg:"未实现的方法"},BIG_ERROR:{code:4294967295,msg:"错误"},SUPER_SUCCESS:{code:0,msg:"成功"}},ERRMAP=ERRMAP_ZHCN;TCACErr.prototype=new Error,tcu.extKeyUsageMap={"1.3.6.1.5.5.7.3.1":"serverAuth","1.3.6.1.5.5.7.3.2":"clientAuth","1.3.6.1.5.5.7.3.3":"codeSigning","1.3.6.1.5.5.7.3.4":"emailProtection","1.3.6.1.5.5.7.3.5":"ipsecEndSystem","1.3.6.1.5.5.7.3.6":"ipsecTunnel","1.3.6.1.5.5.7.3.7":"ipsecUser","1.3.6.1.5.5.7.3.8":"timeStamping","1.3.6.1.5.5.7.3.9":"OCSPSigning","1.3.6.1.5.5.7.3.10":"dvcs","1.3.6.1.5.5.7.3.11":"sbgpCertAAServerAuth","1.3.6.1.5.5.7.3.12":"scvpResponder","1.3.6.1.5.5.7.3.13":"eapOverPPP","1.3.6.1.5.5.7.3.14":"eapOverLAN","1.3.6.1.5.5.7.3.15":"scvpServer","1.3.6.1.5.5.7.3.16":"scvpClient","1.3.6.1.5.5.7.3.17":"ipsecIKE","1.3.6.1.5.5.7.3.18":"capwapAC","1.3.6.1.5.5.7.3.19":"capwapWTP","1.3.6.1.4.1.311.20.2.2":"smartcardlogon"},tcu.isStr=function(r){return"string"==typeof r},tcu.isNum=function(r){return"number"==typeof r},tcu.isBool=function(r){return"boolean"==typeof r},tcu.isUndef=function(r){return"undefined"==typeof r},tcu.isNull=function(r){return"null"==typeof r},tcu.isObj=function(r){return"object"==typeof r},tcu.isArr=function(r){return"[object Array]"===Object.prototype.toString.call(r)},tcu.urlDec=function(r){var e=decodeURI(r);return e===r?r:decodeURI(r.replace(/\+/g," "))},tcu.convKeyUsageArr2Num=function(r){for(var e=0,t=0;t<r.length;t++)"digitalSignature"!=r[t]?"nonRepudiation"!=r[t]?"keyEncipherment"!=r[t]?"dataEncipherment"!=r[t]?"keyAgreement"!=r[t]?"keyCertSign"!=r[t]?"cRLSign"!=r[t]?"encipherOnly"!=r[t]?"decipherOnly"!=r[t]?"contentCommitment"==r[t]&&(e|=TCA.contentCommitment):e|=TCA.decipherOnly:e|=TCA.encipherOnly:e|=TCA.cRLSign:e|=TCA.keyCertSign:e|=TCA.keyAgreement:e|=TCA.dataEncipherment:e|=TCA.keyEncipherment:e|=TCA.nonRepudiation:e|=TCA.digitalSignature;return e},tcu.convKeyUsageNum2Arr=function(r){var e=[];return 0===r?e:(r&TCA.digitalSignature&&e.push("digitalSignature"),r&TCA.nonRepudiation&&e.push("nonRepudiation"),r&TCA.keyEncipherment&&e.push("keyEncipherment"),r&TCA.dataEncipherment&&e.push("dataEncipherment"),r&TCA.keyAgreement&&e.push("keyAgreement"),r&TCA.keyCertSign&&e.push("keyCertSign"),r&TCA.cRLSign&&e.push("cRLSign"),r&TCA.encipherOnly&&e.push("encipherOnly"),r&TCA.decipherOnly&&e.push("decipherOnly"),r&TCA.contentCommitment&&e.push("contentCommitment"),e)},tcu.convSignAlg2Str=function(r){switch(r){case 81:return"SM3WithSM2";case 98:return"SHA1WithRSA"}return"UnknownSignAlg"},tcu.convAlg2SignAlgId=function(r){return r==TCA.RSA1024?98:r==TCA.RSA2048?98:r==TCA.SM2?81:-1},tcu.convPubKeyAlg2Str=function(r){switch(r){case 1:case 2:case 3:case 16:return"RSA";case 17:return"SM2"}return"UnknownAlg"},tcu.convPubKeyAlg2Size=function(r){switch(r){case 1:return 1024;case 2:return 2048;case 3:return 4096;case 17:return 256}return-1},tcu.convExtKeyUsageOID2Name=function(r){for(var e=[],t=0;t<r.length;t++)e.push(tcu.extKeyUsageMap[r[t]]);return e},tcu.convStr2Json=function(jsonStr){return eval("("+jsonStr+")")},tcu.convKeySize2CSP=function(r){return r==TCA.RSA1024?67108864:r==TCA.RSA2048?134217728:r==TCA.SM2?16777216:-1},tcu.strInList=function(r,e){if(e.length<=0)return!1;for(var t=0;t<e.length;t++)if(r===e[t])return!0;return!1},tcu.tcaAlg2SDKAlg=function(r){switch(r){case TCA.SM4:return 65;case TCA.DES:return 67;case TCA.DES3:return 68;case TCA.AES:return 69;case TCA.RC4:return 70;case TCA.SM2:return 17;case TCA.RSA1024:return 1;case TCA.RSA2048:return 2;case TCA.SHA256:return 50;case TCA.SHA1:return 49;case TCA.SM3:return 33;case TCA.MD5:return 51;case TCA.SM1:default:return 0}},tcu.arr2Str=function(r){for(var e="",t=0;t<r.length;t++){var n=r[t];n=n.replace(/\r/g,"\\r").replace(/\n/g,"\\n"),e=e+'"'+n+'", '}return e.length>0&&(e=e.substr(0,e.length-2)),
"["+e+"]"},tcu.json2Str=function(r){var e="{";for(var t in r){e+='"'+t+'":';var n=r[t];tcu.isStr(n)?(n=n.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\"/g,'\\"').replace(/\\/g,"\\\\"),e+='"'+n+'",'):tcu.isNum(n)||tcu.isBool(n)?e+=n+",":tcu.isArr(n)?e+=tcu.arr2Str(n)+",":TCACErr.throwErr(ERRMAP.ERROR_JSON_TYPE)}return e+='"_jsonEnd":"_jsonEnd"}'},tcu.sign=function(r,e,t,n,i,c,a,s,o,A,u,C){var l={certStore:r,certIDArr:e,hash:t,bSignHash:n,bSignP7:i,bAttr:c,bIncCtx:a,bIncCert:s,inType:o,inParam:A,outType:u,outParam:C};l=tcu.json2Str(l);var T,E=TCACore.getInstance();try{T=E.call("Sign/sign",l)}catch(r){return TCACErr.throwErr(r,ERRMAP.SIGN_ERROR),null}return T},tcu.verify=function(r,e,t,n,i,c,a,s,o){var A={b64Cert:r,isHashSign:e,isPkcs7:t,hash:n,verifyOption:i,signInType:c,signInParam:a,plainInType:s,plainInParam:o};A=tcu.json2Str(A);var u,C=TCACore.getInstance();try{u=C.call("Verify/verify",A)}catch(r){return TCACErr.throwErr(r,ERRMAP.VERIFY_ERROR),null}return u},tcu.enc=function(r,e,t,n,i,c,a){var s={certArr:r,symmAlg:e,bEncP7:t,inType:n,inParam:i,outType:c,outParam:a};s=tcu.json2Str(s);var o,A=TCACore.getInstance();try{o=A.call("Enc/enc",s)}catch(r){return TCACErr.throwErr(r,ERRMAP.ENCRYPT_ERROR),null}return o},tcu.dec=function(r,e,t,n,i,c,a){var s={certStore:r,certIDArr:e,bIsP7:t,inType:n,inParam:i,outType:c,outParam:a};s=tcu.json2Str(s);var o,A=TCACore.getInstance();try{o=A.call("Dec/dec",s)}catch(r){return TCACErr.throwErr(r,ERRMAP.DECRYPT_ERROR),null}return o},tcu.checkHashAlg=function(r,e){if("SM2"===this.publicKeyAlg()&&e!=TCA.SM3||"RSA"===this.publicKeyAlg()&&e===TCA.SM3)return TCACErr.throwErr(ERRMAP.SIGN_ERROR_HASH_ALG),null},tcu.getSrvVersion=function(){var r,e=TCA.IO.MSG,t='{"outType" :'+e+"}",n=TCACore.getInstance();try{r=n.call("Server/version",t)}catch(r){return TCACErr.throwErr(r,ERRMAP.ERROR_CALL_SRV_VER),null}return r},tcu.ajax=function(jsonParam){var url=jsonParam.url,data=jsonParam.data,successCallback=jsonParam.success,errorCallback=jsonParam.error,request=new XMLHttpRequest;try{if(request.open("POST",url,!1),request.setRequestHeader("Content-Type","application/json; charset=UTF-8"),request.send(data),200==request.status)return void successCallback(eval("("+request.responseText+")"));errorCallback(request,request.statusText,"no error thrown")}catch(r){errorCallback(request,request.statusText,"send error & no error thrown")}};