<!DOCTYPE html>
<html>
<head>
<title>故障申报</title>
<meta name="keywords" content="keyword1,keyword2,keyword3">
<meta name="description" content="this is my page">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta http-equiv="X-UA-Compatible" content="IE=9" />
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Cache-Control" content="no-cache">
<meta http-equiv="Expires" content="-1">
<script type="text/javascript"
	src="../../Resources/js/xhbootstrap-css.js"></script>
<!-- <link rel="stylesheet" type="text/css"
	href="../../lib/layer-master/src/theme/layer.css"> -->
<!--[if lte IE 9]>
<script src="../../Resources/js/jquery-1.8.3.min.js"></script>
<script src="../../Resources/js/respond.min.js"></script>
<script src="../../Resources/js/html5shiv.js"></script>
<![endif]-->
</head>
<body ng-app="app" ng-controller="xhcontroller" class="fixed-iframe">
	<!-- splash screen-->
	<div class="splash">
		<div class="color-line"></div>
		<div class="splash-title">
			<h1>系统正在努力加载中，请耐心等待</h1>
			<div class="spinner">
				<div class="rect1"></div>
				<div class="rect2"></div>
				<div class="rect3"></div>
				<div class="rect4"></div>
				<div class="rect5"></div>
			</div>
		</div>
	</div>
	<!-- 中间内容体 -->
	<div id="wrapper">
		<div class="small-header transition animated fadeIn">
			<div class="title-panel">
				<div class="panel-body">
					<div id="hbreadcrumb" class="pull-left">
						<ol class="hbreadcrumb breadcrumb">
							<li><span>当前位置：</span></li>
						    <li><span>业务管理</span></li>
							<li><a href="../menu/menu_business.html" target="_self"><span>网办业务</span></a></li>
							<li class="active"><span>故障申报</span></li>
						</ol>
					</div>
					<div class="btn-group pull-right">
						<button class="btn btn-primary btn-sm"
							onclick="javascript:history.back(-1);">
							<i class="fa fa-mail-reply-all"></i>&nbsp;&nbsp;返回上一级
						</button>
					</div>
				</div>
			</div>
		</div>
		<div class="content animate-panel">
			<!-- row -->
			<div class="row">
				<div class="col-md-12">
					<div class="hpanel">
					<div class="panel-heading hbuilt">
							<i class="fa fa-indent text-danger"></i>&nbsp;故障申报列表
						</div>
						<div class="panel-body">
						<div class="btn-group" ng-model="loginUserRoleId">
									
									<button class="btn btn-success btn-sm" data-toggle="modal" data-target="#add"  ng-if="userL.roleType>3">
										<i class="fa fa-plus-circle"></i>&nbsp;故障申报
									</button>
									
								</div>
							<table id="tb-info" class="xh-table table-hover"
								ng-model="loginUser">
								<thead>
									<tr class="tr-gray">
										<th>用户单位</th>
										<th width="100px">联系人</th>
										<th width="100px">联系方式</th>
										<th width="160px">故障信息</th>
										<th width="180px">申请时间</th>
										<th>状态</th>
										<th width="200px">操作详情</th>
									</tr>
								</thead>
								<tbody ng-model="loginUserRoleId">
									<tr ng-if="totals==0">
										<td colspan="7" class="text-center">没有记录！</td>
									</tr>
									<tr ng-repeat="x in data">
										<td>{{x.unit1}}</td>
										<td>{{x.person}}</td>
										<td>{{x.tel}}</td>
										<td>{{x.information}}</td>
										<td>{{x.time}}</td>
										<!-- <td ng-if="x.checked<7" class="td-worning">等待处理</td>
										<td ng-if="x.checked==7" class="td-success">流程结束</td> -->
										<td ng-if="x.checked==-2" class="td-danger">用户拒绝</td>
										<td ng-if="x.checked==-1" class="td-danger">申请已被拒绝</td>
										<td ng-if="x.checked==0" class="">等待管理方领导审核</td>
										<td ng-if="x.checked==1" class="">等待经办人处理</td>
										<td ng-if="x.checked==2" class="">等待管理方上传故障请求信息</td>
										<td ng-if="x.checked==3" class="">等待亚光确认</td>
										<td ng-if="x.checked==4" class="">等待亚光维修故障</td>
										<td ng-if="x.checked==5" class="">等待管理方审核故障完成信息</td>
										<td ng-if="x.checked==6" class="">等待管理方记录故障完成信息</td>
										<td ng-if="x.checked==7" class="">等待用户回访确认</td>
										<td ng-if="x.checked==8" class="td-success">流程结束</td>
										<td style="text-align:center">

										<a href="#"
											ng-click="toProgress($index)"><i
												class="fa fa-file-text-o text-success"> </i>&nbsp;详情
										</a> 

										<a ng-if="userL.roleType==2 && x.checked==0 && up.b_check_fault=='on'"
											href="#" ng-click="checkWin($index)"><i
												class="fa fa-hand-o-down text-danger"></i>| &nbsp;审核</a>
												
											<a ng-if="userL.roleType==2 && x.checked==2 && loginUser == x.checkUser"
											href="#" ng-click="checkWin($index)"><i
												class="fa fa-hand-o-down text-danger"></i>| &nbsp;上传上传故障请求记录</a>
											
										<a ng-if="userL.roleType==3 && x.checked==3 && up.b_check_fault=='on'"
											href="#" ng-click="checkWin($index)"><i
												class="fa fa-hand-o-down text-danger"></i>| &nbsp;确认收到通知</a>	
									
												
												
												
												
									 <a ng-if="loginUser == x.user2 && userL.roleType==3 && x.checked==4 && up.b_check_fault=='on'"
											href="#" ng-click="checkWin($index)"><i
												class="fa fa-hand-o-down text-danger"></i>| &nbsp;上传故障处理报告</a>
												
												
									<a ng-if="userL.roleType==2 && x.checked==5 && loginUser == x.checkUser"
											href="#" ng-click="checkWin($index)"><i
												class="fa fa-hand-o-down text-danger"></i>| &nbsp;审核故障处理报告</a>
									
									<a ng-if="userL.roleType==2 && x.checked==6 && loginUser == x.checkUser"
											href="#" ng-click="checkWin($index)"><i
												class="fa fa-hand-o-down text-danger"></i>| &nbsp;记录故障信息</a>

										<a ng-if="userL.roleType==2 && x.checked==1 && loginUser == x.checkUser"
											href="#" ng-click="checkWin($index)"><i
												class="fa fa-hand-o-down text-danger"></i>| &nbsp;处理</a>
										
										<a class="text-danger"
											ng-if="loginUser==x.userName && loginUserRoleId==1000 && x.checked==7"
											href="#" ng-click="checkWin($index)">|<i
												class="fa fa-hand-o-down text-danger"></i>&nbsp;确认</a>

										</td>
									</tr>
								</tbody>
							</table>
							<div class="page">
								<div class="page-info">
									<span>每页显示</span><select id="page-limit" ng-change="refresh()"
										ng-model="count">
										<option value="15">15</option>
										<option value="20">20</option>
										<option value="30">30</option>
										<option value="40">40</option>
										<option value="50">50</option>
									</select> <span>条,</span><span ng-model="index">显示{{start}}-</span><span
										ng-model="lastIndex">{{lastIndex}}条,</span> <span
										ng-model="totals">总计{{totals}}条</span>
									<i class="fa fa-refresh page-refresh" title="刷新数据" ng-click="refresh()"></i>
								</div>
								<div class="page-paging"></div>
							</div>
							<!-- row -->
							<div class="row">
								<div class="col-md-12"></div>
							</div>
							<!-- row -->
						</div>
						<!-- panel-body--end -->
						
						<!-- hpanel --end-->
					</div>
					<!-- col-md-12--end -->
				</div>
				<!-- row/ -->
			</div>
		</div>
	</div>
	
	<div class="scroll-top text-info animated fadeIn scroll-top-hide">
		<i class="fa fa-chevron-circle-up fa-3x"></i>
	</div>
	<!-- 添加 -->
	<div ng-include="'fault-add.html'"></div>
	<!-- 进度-->
	<div ng-include="'fault-progress.html'"></div>
	<!-- 审核-->
	<div ng-include="'fault-check.html'"></div>
	<script type="text/javascript"
		src="../../Resources/js/xhbootstrap-js.js"></script>
	<script type="text/javascript"
		src="../../lib/metisMenu/dist/metisMenu.min.js"></script>
	<script type="text/javascript"
		src="../../Resources/js/ajaxfileupload.js"></script>
	<script type="text/javascript" src="../../Controllers/business/fault.js"></script>
	<script type="text/javascript"
		src="../../lib/layer-master/src/layer.js"></script>
	<script type="text/javascript">
		xh.load();
	</script>
</body>
</html>
