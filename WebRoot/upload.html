<!DOCTYPE html>
<html>
  <head>
    <title>upload.html</title>
	
    <meta name="keywords" content="keyword1,keyword2,keyword3">
    <meta name="description" content="this is my page">
    <meta name="content-type" content="text/html; charset=UTF-8">
    <script src="Resources/js/jquery-1.8.3.min.js"></script>
    
    <!--<link rel="stylesheet" type="text/css" href="./styles.css">-->

  </head>
  
  <body>
 <!--   <form action="#" enctype="multipart/form-data" onsubmit="false">      
                   上传文件<input type="file" name="file1" id="ff"><br/>
                   上传文件<input type="file" name="file2"><br/>
         <input type="submit" value="提交" id="uploadFile">
     </form> -->
     
     <form action="#" onsubmit="false" > 
                 上传文件<input type="file" name="file1" id="ff"><br/>
         <input type="button" value="提交" onclick="uploadfile()">
     </form>
     <script type="text/javascript">
     function uploadfile(){
    	// var form = new FormData(document.getElementById("tf"));

         var obj=document.getElementById("ff").files[0];
         
        // FormData 对象
         var form = new FormData();
         form.append("author", "hooyes");                        // 可以增加表单数据
         form.append("pathName", obj);                           // 文件对象
         
         // XMLHttpRequest 对象

         var xhr = new XMLHttpRequest();

         xhr.open("post", "img/upload", true);

       /*   xhr.onload = function (data) {
        	 
        	 console.log(JSON.stringify(data))

             alert("上传完成!"+data);

         }; */
         xhr.onreadystatechange = function(){
             if(xhr.readyState==4&&xhr.status==200){
                 var json=JSON.parse(xhr.responseText);
                 console.log(json);
             }
         };
         xhr.upload.onprogress = function(event){
        	    if(event.lengthComputable){
        	        // 当前上传的百分比
        	        duringCallback((event.loaded/event.total)*100)
        	        console.log("进度："+(event.loaded/event.total)*100);
        	    }
        	}


         xhr.send(form);
     }
     function uploadfile2(){
    	  var obj=document.getElementById("ff").files[0];
    	  
    	  var reader = new FileReader();
    	  reader.readAsDataURL(obj);
    	  reader.onload = function(e){
    	      console.log(e.target.result);
    	      obj=e.target.result
    	    };
          
          // FormData 对象
           var form = new FormData();
           form.append("author", "hooyes");                        // 可以增加表单数据
           form.append("file", obj);  
    	    $.ajax({
    	        url : 'img/upload',
    	        type : 'POST',
    	        dataType:"json",
    	        /* processData:false,
                contentType:false, */
    	        data:JSON.stringify(form),
    	        success : function(data) {
    	        	console.log(JSON.stringify(data))
    	        },
    	        error : function(data) {
    	        	console.error(JSON.stringify(data))
    	        }
    	    });
     }
     </script>
  </body>
</html>
